<!DOCTYPE html>
{% extends 'base.html' %}
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post Detalle - {{ Post.titulo }}</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
    {% block header%}

    {% endblock %}
    {% block content %}
    <div class="container mt-5">
        <article style="max-width: 800px; margin: 0 auto; padding: 20px;" class="post-detail">
            <header class="post-header mb-4">
                <h1>{{ Post.titulo }}</h1>
                <p class="post-meta">Publicado el {{ Post.fecha_publicacion }} por {{ Post.autor.username }}</p>
            </header>
    
            {% if Post.imagen %}
                <figure class="post-image mb-4">
                    <img src="{{ Post.imagen.url }}" alt="Post Image" 
                         style="width: 100%; height: auto; max-height: 400px; object-fit: cover;" class="img-fluid">
                </figure>
            {% endif %}
    
            <section>
                <p class="clase ver">{{ Post.resumen }}</p>
                <div class="clase ver">
                    {{ Post.contenido|safe }} <!-- Use safe filter to render rich text -->
                </div>
            </section>
    
            <footer>
                <p>Categorías:
                    {% for categoria in Post.categorias.all %}
                        <a href="#">{{ categoria.nombre }}</a>{% if not forloop.last %}, {% endif %}
                    {% endfor %}
                </p>
            </footer>
        </article>
    </div>
    {% endblock %}
    

        <!-- Sidebar block -->
        {% block sidebar %}
        <h2>Comentarios</h2>
        <div>
            {% for comentario in comentarios %}
                <div>
                    <p><strong>{{ comentario.autor_comentario  }}</strong> dijo:</p>
                    <blockquote>{{ comentario.cuerpo_comentario }}</blockquote>
                    <p><small>Publicado el {{ comentario.fecha_creado |date:"d F - Y"  }}</small></p>
                </div>
            {% empty %}
                <p >No hay comentarios para este post.</p>
            {% endfor %}
        </div>

        {% if user.is_authenticated %}
            <h3>Deja un comentario:</h3>
            <form method="post">
                {% csrf_token %}
                {{ form.as_p }}  <!-- Esto renderiza el formulario -->
                <button type="submit"  class="btn btn-primary">Enviar</button>
            </form>
        {% else %}
            <p>Debes <a href="{% url 'login' %}">iniciar sesión</a> para comentar.</p>
        {% endif %}
        {% endblock %}
    
    <script src="{% static 'js/app.js' %}"></script>
</body>
</html>
